version: "3.9"

services:

  # ------------------------
  # JARVIS BACKEND
  # ------------------------
  jarvis-backend:
    build: .
    container_name: jarvis-backend
    ports:
      - "9000:8000"
    restart: unless-stopped
    env_file:
      - .env
    depends_on:
      - wyoming-whisper
      - wyoming-piper
      - wyoming-openwakeword
    networks:
      - jarvis

  # ------------------------
  # WHISPER STT
  # ------------------------
  wyoming-whisper:
    image: rhasspy/wyoming-whisper:latest
    container_name: wyoming-whisper
    ports:
      - "10300:10300"
    command: >
      --model tiny-int8
      --language de
      --uri tcp://0.0.0.0:10300
    restart: unless-stopped
    networks:
      - jarvis

  # ------------------------
  # PIPER TTS
  # ------------------------
  wyoming-piper:
    image: rhasspy/wyoming-piper:latest
    container_name: wyoming-piper
    ports:
      - "10200:10200"
    command: >
      --voice de_DE-thorsten-low
      --uri tcp://0.0.0.0:10200
    restart: unless-stopped
    networks:
      - jarvis

  # ------------------------
  # OPENWAKEWORD
  # ------------------------
  wyoming-openwakeword:
    image: rhasspy/wyoming-openwakeword:latest
    container_name: wyoming-openwakeword
    ports:
      - "10400:10400"
    command: >
      --uri tcp://0.0.0.0:10400
    restart: unless-stopped
    networks:
      - jarvis

# ------------------------
# NETWORKS
# ------------------------
networks:
  jarvis:
    driver: bridge

